<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="res/blog.css" type="text/css">
<link rel="alternate" type="application/rss+xml" title="Subscribe to this page..." href="feed.rss">
<link rel="icon" type="image/webp" href="img/logo.webp"/>
<title>Japanese fonts</title>
<meta property="og:title" content="Japanese fonts">
<meta property="og:site_name" content="Tatsumoto Ren">
<meta property="og:url" content="https://tatsumoto-ren.github.io/blog/japanese-fonts.html">
<meta property="og:description" content="How to use Free Software to learn Japanese, and more.">
<meta property="og:image" content="https://tatsumoto-ren.github.io/blog/img/logo.webp">
</head>
<body>
<div id="headerholder" class="headerholder">
    <header>
        <div class="logoholder">
            <a href="index.html" class="logo">
                <img alt="達元" src="img/logo.webp" />
                <h1>Tatsumoto</h1>
            </a>
        </div>
        <input class="menu" type="checkbox" id="menu-btn" />
        <label class="menu" for="menu-btn"><span class="hamburger"></span></label>
        <div id="description">How to use Free Software to learn Japanese, and more.</div>
        <nav>
            <a href="table-of-contents.html">Guide</a>
            <a href="our-immersion-learning-toolset.html">Tools</a>
            <a href="donating-to-tatsumoto.html">Support</a>
            <a href="join-our-community.html" class="important">Join chat</a>
        </nav>
    </header>
</div>
<div id="divbodyholder">
<div id="divbody">
<main>
<!-- entry begin -->
<article>
<h1 class="title"><a class="ablack" href="japanese-fonts.html">Japanese fonts</a></h1>
<!-- bashblog_timestamp: #1624216840# -->
<div class="subtitle">June 20, 2021 &mdash; Tatsumoto</div>
<!-- text begin -->
<p>On a freshly installed GNU/Linux distro
Japanese characters may not look pretty.
This can be fixed by installing
<a href="https://wiki.archlinux.org/title/Localization/Japanese#Fonts">Japanese fonts</a>
and creating a proper
<a href="https://wiki.archlinux.org/title/Font_configuration">Fontconfig</a>
configuration file.</p>
<hr>
<h2 id="chinese-glyphs"><a class="anchor" href="#chinese-glyphs" title="Permanent link"><svg aria-hidden="true" class="aal_svg" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Chinese glyphs</h2>
<blockquote>
<p>Unicode is a retarded pile of crap maintained by morons.</p>
<p><em>― A comment on Ask Ubuntu</em></p>
</blockquote>
<p>One thing to beware of is Chinese glyphs.
Unicode uses a unified database for CJK characters called Unihan.
Unfortunately, kanji characters in Chinese and Japanese don't look the same.
Depending on the font used,
a single Unicode character may be represented by different glyphs.
If your system prioritizes Chinese fonts over Japanese fonts,
it will display kanji with a Chinese font instead of a Japanese one,
and it's not what you want.
No matter what OS or device you use, you may be affected if your settings are off.</p>
<p>Certain kanji characters may look drastically different if a Chinese font is used.
A prominent example is <code>直</code>.
This kanji is quite common and can be seen in words like <code>正直</code> or <code>直ぐ</code>.</p>
<p align="center"><img src="img/glyph_comparison.webp"></p>
<p align="center"><i>Noto Serif CJK SC vs Noto Serif CJK JP.</i></p>
<p>If <code>直</code> renders without the vertical line on the left side,
your browser is using Chinese fonts for Japanese.
You need to install Japanese fonts and change your system settings.</p>
<h2 id="locale"><a class="anchor" href="#locale" title="Permanent link"><svg aria-hidden="true" class="aal_svg" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Locale</h2>
<p>First and foremost, ensure that you have generated the Japanese
<a href="https://wiki.archlinux.org/title/Locale">locale</a>.
You may have font-rendering issues if you don't do that.
Uncomment the languages you use in <code>/etc/locale.gen</code>
by removing the <code>#</code>s from their corresponding lines.</p>
<pre><code>en_US.UTF-8 UTF-8
ja_JP.UTF-8 UTF-8
</code></pre>
<p>Then save the file and regenerate the locale:</p>
<pre><code>$ sudo locale-gen
</code></pre>
<h2 id="installing-fonts"><a class="anchor" href="#installing-fonts" title="Permanent link"><svg aria-hidden="true" class="aal_svg" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Installing fonts</h2>
<p>Install
<a href="https://ipafont.ipa.go.jp/">otf-ipafont</a>
and
<a href="https://www.google.com/get/noto/">noto-fonts-cjk</a>.
I also recommend installing Noto fonts for non-Asian languages and the Noto Emoji font.
Arch Linux users can do everything with this command:</p>
<pre><code>$ sudo pacman -S --needed otf-ipafont noto-fonts noto-fonts-cjk noto-fonts-emoji
</code></pre>
<p>If you're installing fonts manually,
they need to be saved in a directory known to Fontconfig.
This is either <code>~/.local/share/fonts</code> or <code>/usr/share/fonts/</code>.</p>
<p>To list installed fonts, run <code>fc-list</code>.
To update the font cache, run <code>fc-cache -fv</code>
(usually unnecessary as software using the fontconfig library does this).</p>
<h2 id="fontconfig"><a class="anchor" href="#fontconfig" title="Permanent link"><svg aria-hidden="true" class="aal_svg" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Fontconfig</h2>
<p>Fontconfig affects what fonts are used system-wide.
By applying Fontconfig settings you can kill all birds with one stone,
bypassing the need to individually configure each program you use.
This applies to fonts in your browser, Yomichan popups, Anki, etc.</p>
<p>Create a config file <code>~/.config/fontconfig/conf.d/99-japanese-fonts.conf</code>.
The name of the file should always start with a two-digit number.
Applications automatically find and read this file
to discover available fonts and how they get rendered.
After you make changes to it,
you may need to restart the applications to load the new configuration.
In a web browser, it is usually sufficient to reload a page.</p>
<p>Below you can find a recommended configuration file to render Japanese fonts.</p>
<p align="center"><a class="download_button" href="https://github.com/tatsumoto-ren/dotfiles/blob/main/.config/fontconfig/conf.d/99-japanese-fonts.conf">Download</a>
<p>Without the settings, Japanese text looks pixelated.
Truly a nightmare.</p>
<p align="center"><img alt="comparison" src="img/fontconfig_difference.webp"></p>
<p align="center"><i>A file manager app before and after applying Fontconfig settings.</i></p>
<p>The config disables bitmap fonts.
According to Arch Wiki,
bitmap fonts are sometimes used as fallbacks for missing fonts,
which may cause text to be rendered pixelated.
If you think you need them, set <code>embeddedbitmap</code> to <code>true</code>.</p>
<h2 id="fonts-in-gtk-apps"><a class="anchor" href="#fonts-in-gtk-apps" title="Permanent link"><svg aria-hidden="true" class="aal_svg" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Fonts in GTK apps</h2>
<p>Install <a href="https://archlinux.org/packages/?name=lxappearance">lxappearance</a>.
The program lets you change various font settings.
Antialiasing and hinting aren't too noticeable,
feel free to experiment for yourself.
I just leave them on.</p>
<p align="center"><img class="shadow" alt="lxappearance" src="img/lxappearance_font_settings.webp"></p>
<p>The setting that does noticeably affect how text looks is sub-pixel geometry.
If it's set to &quot;RGB&quot;, the text turns into a rainbow, so I recommend keeping it at &quot;none&quot;.</p>
<p align="center"><img alt="comparison" src="img/rgb_on_off.webp"></p>
<p align="center"><i>RGB on and off.</i></p>
<p>Some applications ignore Fontconfig settings.
You can work around this by using
<a href="https://wiki.archlinux.org/title/X_resources">X resources</a>.
Below is a snippet from my <code>~/.Xresources</code> file.</p>
<pre><code>Xft.antialias:	1
Xft.autohint:	0
Xft.dpi:	96
Xft.hinting:	1
Xft.hintstyle:	hintslight
Xft.lcdfilter:	lcddefault
Xft.rgba:	none
</code></pre>
<p><strong>Note:</strong> Make sure that you load the X resources file on login.
If it doesn't happen automatically, you need to edit your <code>.xinitrc</code> file or change other settings.
Refer to Arch Wiki for instructions.</p>
<h2 id="firefox"><a class="anchor" href="#firefox" title="Permanent link"><svg aria-hidden="true" class="aal_svg" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Firefox</h2>
<p>Firefox should automatically pick up your Fontconfig settings.
If it doesn't, go to &quot;Settings&quot; &gt; &quot;Fonts and Colors&quot; and set the fonts there.</p>
<h2 id="yomichan"><a class="anchor" href="#yomichan" title="Permanent link"><svg aria-hidden="true" class="aal_svg" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Yomichan</h2>
<p>Likewise, no special configuration required.
If you wish to specify a different font, edit the Popup CSS.</p>
<p>Go to Yomichan Settings &gt; &quot;Appearance&quot; &gt; &quot;Configure custom CSS...&quot;.
Use the browser's &quot;Inspect&quot; feature to find out CSS class names you want to apply font settings to.
For example, the content of dictionary definitions
can be styled by editing rules for <code>.gloss-content</code>.
Alternatively, you can apply settings to <code>body</code> to change the font of the entire Popup.</p>
<pre><code>.gloss-content {
   font-family: Yu Mincho;
}
</code></pre>
<h2 id="anki"><a class="anchor" href="#anki" title="Permanent link"><svg aria-hidden="true" class="aal_svg" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Anki</h2>
<p>Anki has a feature that allows you to store font files in the <code>collection.media</code> folder
and sync them with all your devices, including mobile.
The purpose of this feature is not to enable Anki to display the right fonts,
they should work properly as long as you've completed the steps above.
It is to let you have the same fonts on all your devices
without the need to install them on each device separately.</p>
<p>The
<a href="setting-up-anki.html#import-an-example-mining-deck">recommended example deck</a>
comes with built-in Japanese fonts, no additional action is needed.
If you wish to use a different deck, follow the steps below.</p>
<ol>
<li><p>Copy the font file of your choice to <code>~/.local/share/Anki2/PROFILE/collection.media</code>,
where <code>PROFILE</code> is your profile name.
The filename must start with <code>_</code> or Anki will delete the file if you run &quot;Tools&quot; &gt; &quot;Check media&quot;.
For this example I'm going to use a font called <code>_yumin.ttf</code>.</p>
</li>
<li><p>Open your Note Type settings.
Go to &quot;Tools&quot; &gt; &quot;Manage Note Types&quot; &gt; choose your Note Type &gt; &quot;Cards&quot; &gt; &quot;Styling&quot;.</p>
</li>
<li><p>Paste the following CSS to tell Anki to load the font when you open the Reviewer.</p>
<pre><code>@font-face {
    font-family: &quot;Yu Mincho&quot;;
    src:
        local(&quot;Yu Mincho&quot;),
        local(&quot;游明朝&quot;),
        url(&quot;_yumin.ttf&quot;);
}
</code></pre>
<p>The <code>local</code> setting makes sure the font doesn't get loaded
if it's already installed system-wide.
Mind what name you specify for the font.</p>
</li>
<li><p>Scroll down to <code>.card</code> class and change or append the font's name to <code>font-family</code>.</p>
<pre><code>.card {
    font-family: Yu Mincho;
}
</code></pre>
</li>
</ol>
<p>If you review on Android,
note that there's a bug that causes AnkiDroid to run out of memory
and crash when using fonts stored in <code>collection.media</code>.
If this happens to you,
consider installing a different WebView implementation or not using custom fonts at all.</p>
<h2 id="android"><a class="anchor" href="#android" title="Permanent link"><svg aria-hidden="true" class="aal_svg" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Android</h2>
<p>If you happen to see Chinese fonts on Android,
simply add Japanese to the list of system languages.
To do so, go to &quot;Settings&quot; &gt; &quot;System&quot; &gt; &quot;Language and input&quot;.</p>
<p align="center"><img style="width: 400px;" alt="android settings" src="img/android_languages.webp"></p>
<p align="center"><i>A list of system languages.</i></p>
<h2 id="conclusion"><a class="anchor" href="#conclusion" title="Permanent link"><svg aria-hidden="true" class="aal_svg" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Conclusion</h2>
<p>Now that you've configured Japanese fonts, you're ready to learn Japanese.
You won't accidentally learn Chinese versions of kanji
because your computer refuses to render them with Japanese glyphs.</p>
<p align="center"><img style="width: 600px;" src="img/japanese_text.webp"></p>
<p align="center"><i>How Japanese looks on my computer.</i></p>
<p>Now I hope you see why GNU/Linux is the best OS for learning Japanese.
On Windows, fonts look like shit no matter what you do to fix them.
They're pixelated, and they literally glow.</p>
<p align="center"><img alt="comparison" src="img/windows_ui_example.webp"></p>
<p align="center"><i>How fonts typically look on Windows.</i></p>
<p>Tags: <a href="tag_guide.html">guide</a></p>
<!-- text end -->
</article>
<!-- entry end -->
</main>
</div>
</div>
<footer>
    <p>Copyright © <a href="mailto:tatsu@autistici.org">Tatsumoto</a> 2020-2021</p>
    <p>Generated with <a href="https://github.com/cfenollosa/bashblog">bashblog</a>, a single bash script to easily create blogs like this one</p>
</footer>
<script src="res/blog.js"></script>
</body>
</html>
